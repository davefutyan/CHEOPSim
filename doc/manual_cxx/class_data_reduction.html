<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>CHEOPSim: DataReduction Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="cheops-logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">CHEOPSim
   &#160;<span id="projectnumber">06</span>
   </div>
   <div id="projectbrief">Simulation software for CHEOPS SOC</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_data_reduction-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DataReduction Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module performs a basic photometric extraction from the set of stacked images that have been generated.  
 <a href="class_data_reduction.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_data_reduction_8hxx_source.html">DataReduction.hxx</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for DataReduction:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_data_reduction.png" usemap="#DataReduction_map" alt=""/>
  <map id="DataReduction_map" name="DataReduction_map">
<area href="class_module.html" title="Base class for all CHEOPSim modules. " alt="Module" shape="rect" coords="0,0,94,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_data_reduction_1_1_flux.html">Flux</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct to hold the extracted flux time series.  <a href="struct_data_reduction_1_1_flux.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a502c2f8301c7f0dbf997b99da38a5c2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a502c2f8301c7f0dbf997b99da38a5c2d">initialize</a> (const ModuleParams &amp;params)</td></tr>
<tr class="memdesc:a502c2f8301c7f0dbf997b99da38a5c2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the module by reading in parameters from the configuration file.  <a href="#a502c2f8301c7f0dbf997b99da38a5c2d">More...</a><br /></td></tr>
<tr class="separator:a502c2f8301c7f0dbf997b99da38a5c2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add2ae86b0e9ba53b9602f515509ac09d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#add2ae86b0e9ba53b9602f515509ac09d">doBegin</a> (<a class="el" href="class_data.html">Data</a> *data, bool fullFrame=false)</td></tr>
<tr class="memdesc:add2ae86b0e9ba53b9602f515509ac09d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Further module initialization with access to data initialized by other modules. Called after preceding modules have been initialized.  <a href="#add2ae86b0e9ba53b9602f515509ac09d">More...</a><br /></td></tr>
<tr class="separator:add2ae86b0e9ba53b9602f515509ac09d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca48f611bd601bc5add6922eb6d745ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#aca48f611bd601bc5add6922eb6d745ae">process</a> (<a class="el" href="class_data.html">Data</a> *data, int timeStep, bool fullFrame=false) const </td></tr>
<tr class="memdesc:aca48f611bd601bc5add6922eb6d745ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processing of the data. Called for each time step of the simulation if Module::Schedule is timeLoop (default), otherwise called once.  <a href="#aca48f611bd601bc5add6922eb6d745ae">More...</a><br /></td></tr>
<tr class="separator:aca48f611bd601bc5add6922eb6d745ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02e683da2d5cbabb94b4808b2d8754c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a02e683da2d5cbabb94b4808b2d8754c0">doEnd</a> (<a class="el" href="class_data.html">Data</a> *data) const </td></tr>
<tr class="memdesc:a02e683da2d5cbabb94b4808b2d8754c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">For processing of data after the time loop (data reduction)  <a href="#a02e683da2d5cbabb94b4808b2d8754c0">More...</a><br /></td></tr>
<tr class="separator:a02e683da2d5cbabb94b4808b2d8754c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_module"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_module')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_module.html">Module</a></td></tr>
<tr class="memitem:ae0a73efd635fc18f1ba321832e1ae05b inherit pub_methods_class_module"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_module.html#ae0a73efd635fc18f1ba321832e1ae05b">Module</a> (std::string name, <a class="el" href="class_module.html#ac47ec2094c2373341b6b9e2cce7b12bc">SCHEDULE</a> <a class="el" href="class_module.html#aad6050e202fb69becc2f04388f7db540">schedule</a>=<a class="el" href="class_module.html#ac47ec2094c2373341b6b9e2cce7b12bcabbb5130de0a6b70ac5313e4d51e0b896">timeLoop</a>)</td></tr>
<tr class="memdesc:ae0a73efd635fc18f1ba321832e1ae05b inherit pub_methods_class_module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor initializes module name and scheduling.  <a href="#ae0a73efd635fc18f1ba321832e1ae05b">More...</a><br /></td></tr>
<tr class="separator:ae0a73efd635fc18f1ba321832e1ae05b inherit pub_methods_class_module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb5ccdae3385058610363f1c962d414b inherit pub_methods_class_module"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adb5ccdae3385058610363f1c962d414b"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_module.html#adb5ccdae3385058610363f1c962d414b">getName</a> ()</td></tr>
<tr class="memdesc:adb5ccdae3385058610363f1c962d414b inherit pub_methods_class_module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the name of the module. <br /></td></tr>
<tr class="separator:adb5ccdae3385058610363f1c962d414b inherit pub_methods_class_module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad6050e202fb69becc2f04388f7db540 inherit pub_methods_class_module"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aad6050e202fb69becc2f04388f7db540"></a>
<a class="el" href="class_module.html#ac47ec2094c2373341b6b9e2cce7b12bc">SCHEDULE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_module.html#aad6050e202fb69becc2f04388f7db540">schedule</a> ()</td></tr>
<tr class="memdesc:aad6050e202fb69becc2f04388f7db540 inherit pub_methods_class_module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the scheduling of the module in the processing sequence. <br /></td></tr>
<tr class="separator:aad6050e202fb69becc2f04388f7db540 inherit pub_methods_class_module"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a31c847bf3055e3eca136362e34c2172c"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="struct_data_reduction_1_1_flux.html">Flux</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a31c847bf3055e3eca136362e34c2172c">extractFluxVector</a> (<a class="el" href="class_data.html">Data</a> *data) const </td></tr>
<tr class="memdesc:a31c847bf3055e3eca136362e34c2172c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform photometric extraction: reads in the set of image cubes and for each cube calls extractFluxesFromCube.  <a href="#a31c847bf3055e3eca136362e34c2172c">More...</a><br /></td></tr>
<tr class="separator:a31c847bf3055e3eca136362e34c2172c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a042f2a5b8c36cd293a830a3ce2392956"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a042f2a5b8c36cd293a830a3ce2392956"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a042f2a5b8c36cd293a830a3ce2392956">extractFluxesFromCube</a> (<a class="el" href="class_data.html">Data</a> *data, string filename, int &amp;nFiles, int &amp;nImages, vector&lt; <a class="el" href="struct_data_reduction_1_1_flux.html">Flux</a> &gt; &amp;extractedFlux) const </td></tr>
<tr class="memdesc:a042f2a5b8c36cd293a830a3ce2392956"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform photometric extraction for images within the current image cube and assigns jitter AOCS and science validity flags. Calls <a class="el" href="class_photometry.html#ab640711a69e3b047a2a9a6c163f26e34" title="Performs photometric extraction, optionally with background subtraction and flat field correction...">Photometry::extractFlux</a> for each image.  <a href="#a042f2a5b8c36cd293a830a3ce2392956">More...</a><br /></td></tr>
<tr class="separator:a042f2a5b8c36cd293a830a3ce2392956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2ba9e7b8c4edbeb0fc7ac47cce671b3"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:ab2ba9e7b8c4edbeb0fc7ac47cce671b3"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#ab2ba9e7b8c4edbeb0fc7ac47cce671b3">setTimeConfigurationFromImageCube</a> (<a class="el" href="class_data.html">Data</a> *data, unsigned nImages) const </td></tr>
<tr class="memdesc:ab2ba9e7b8c4edbeb0fc7ac47cce671b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">For the case where data reduction is run on a pre-existing set of images from an earlier simulation, use the total number of images that have been processed together with header keywords from the image cubes to define the time configuration, so that time related header keywords can be set for the output light curves.  <a href="#ab2ba9e7b8c4edbeb0fc7ac47cce671b3">More...</a><br /></td></tr>
<tr class="separator:ab2ba9e7b8c4edbeb0fc7ac47cce671b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a759e9093b90c45b19785c55d2f7550"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a4a759e9093b90c45b19785c55d2f7550">writeIncidentLightCurve</a> (<a class="el" href="class_data.html">Data</a> *data) const </td></tr>
<tr class="memdesc:a4a759e9093b90c45b19785c55d2f7550"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the incident light curve, including normalized curve.  <a href="#a4a759e9093b90c45b19785c55d2f7550">More...</a><br /></td></tr>
<tr class="separator:a4a759e9093b90c45b19785c55d2f7550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31699d58ae64ce9a433ab362427c8068"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a31699d58ae64ce9a433ab362427c8068">writeOutputLightCurves</a> (<a class="el" href="class_data.html">Data</a> *data, vector&lt; <a class="el" href="struct_data_reduction_1_1_flux.html">Flux</a> &gt; &amp;extractedFlux) const </td></tr>
<tr class="memdesc:a31699d58ae64ce9a433ab362427c8068"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the output light curves, including normalized and O-C curves.  <a href="#a31699d58ae64ce9a433ab362427c8068">More...</a><br /></td></tr>
<tr class="separator:a31699d58ae64ce9a433ab362427c8068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e627007269157d825523862245b1b0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a6e627007269157d825523862245b1b0a">setLightCurveHeaderKeywords</a> (<a class="el" href="class_data.html">Data</a> *data, SciCorLightcurve *lightCurve, UTC lastImageMidTime, bool photometry=false) const </td></tr>
<tr class="memdesc:a6e627007269157d825523862245b1b0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the header keywords for a light curve, calling either setLightCurveHeaderKeywordsFromImageCube or setLightCurveHeaderKeywordsWithoutImageCube.  <a href="#a6e627007269157d825523862245b1b0a">More...</a><br /></td></tr>
<tr class="separator:a6e627007269157d825523862245b1b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f49f89d6f23d1d347f526e6952f25b6"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a5f49f89d6f23d1d347f526e6952f25b6"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a5f49f89d6f23d1d347f526e6952f25b6">setLightCurveHeaderKeywordsFromImageCube</a> (SciCorLightcurve *lightCurve, T *imageCube) const </td></tr>
<tr class="memdesc:a5f49f89d6f23d1d347f526e6952f25b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the header keywords for a light curve by copying header keywords from the last image cube to be processed.  <a href="#a5f49f89d6f23d1d347f526e6952f25b6">More...</a><br /></td></tr>
<tr class="separator:a5f49f89d6f23d1d347f526e6952f25b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e535ce9318f2501e73edc328e6e6c8a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a2e535ce9318f2501e73edc328e6e6c8a">setLightCurveHeaderKeywordsWithoutImageCube</a> (const <a class="el" href="class_data.html">Data</a> *data, SciCorLightcurve *lightCurve) const </td></tr>
<tr class="memdesc:a2e535ce9318f2501e73edc328e6e6c8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">For the case where only an incident light curve is generated such that there are no image cubes, set the header keywords explicitly.  <a href="#a2e535ce9318f2501e73edc328e6e6c8a">More...</a><br /></td></tr>
<tr class="separator:a2e535ce9318f2501e73edc328e6e6c8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab80507d02d7302887837a538c5dd4f6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#ab80507d02d7302887837a538c5dd4f6e">setLightCurveData</a> (SciCorLightcurve *lightCurve, double flux, UTC midTime, int status, double rollAngle=-1., double centroidX=0., double centroidY=0., double locationX=0., double locationY=0.) const </td></tr>
<tr class="memdesc:ab80507d02d7302887837a538c5dd4f6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a row of the light curve FITS table.  <a href="#ab80507d02d7302887837a538c5dd4f6e">More...</a><br /></td></tr>
<tr class="separator:ab80507d02d7302887837a538c5dd4f6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b3f671d10063931688b1cf1e7b8ac51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a1b3f671d10063931688b1cf1e7b8ac51">generateNoiseCurve</a> (const <a class="el" href="class_data.html">Data</a> *data, const vector&lt; double &gt; flux, UTC lastImageMidTime, string filename) const </td></tr>
<tr class="memdesc:a1b3f671d10063931688b1cf1e7b8ac51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a noise curve from the data in the extracted light curve.  <a href="#a1b3f671d10063931688b1cf1e7b8ac51">More...</a><br /></td></tr>
<tr class="separator:a1b3f671d10063931688b1cf1e7b8ac51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a958aff2212703f0704826c437d512ef3"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a958aff2212703f0704826c437d512ef3"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a958aff2212703f0704826c437d512ef3">setNoiseCurveHeaderKeywordsFromImageCube</a> (SimAnaNoisecurve &amp;noiseCurve, T *imageCube) const </td></tr>
<tr class="memdesc:a958aff2212703f0704826c437d512ef3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the header keywords for the noise curve by copying header keywords from the last image cube to be processed.  <a href="#a958aff2212703f0704826c437d512ef3">More...</a><br /></td></tr>
<tr class="separator:a958aff2212703f0704826c437d512ef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10404d8ce1fcf740ede37a8c7df5df26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a10404d8ce1fcf740ede37a8c7df5df26">writeExtractedFlux</a> (<a class="el" href="class_data.html">Data</a> *data, double flux) const </td></tr>
<tr class="memdesc:a10404d8ce1fcf740ede37a8c7df5df26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends the extracted flux from the first image to an ascii file. This can be used together with the extractedFlux.sh script to generate an array of extracted flux values for different magnitudes and spectral types.  <a href="#a10404d8ce1fcf740ede37a8c7df5df26">More...</a><br /></td></tr>
<tr class="separator:a10404d8ce1fcf740ede37a8c7df5df26"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a04ec0ee7bdb9ba77a6ac3a684d895a66"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a04ec0ee7bdb9ba77a6ac3a684d895a66"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a04ec0ee7bdb9ba77a6ac3a684d895a66">m_imageDirectory</a></td></tr>
<tr class="memdesc:a04ec0ee7bdb9ba77a6ac3a684d895a66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of directory containing input images, for case where data reduction is performed on a pre-existing set of images. <br /></td></tr>
<tr class="separator:a04ec0ee7bdb9ba77a6ac3a684d895a66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9db493fbb9ebd55c35019048bff7984"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac9db493fbb9ebd55c35019048bff7984"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#ac9db493fbb9ebd55c35019048bff7984">m_outputDirectory</a></td></tr>
<tr class="memdesc:ac9db493fbb9ebd55c35019048bff7984"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of output directory. <br /></td></tr>
<tr class="separator:ac9db493fbb9ebd55c35019048bff7984"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb4cb8a6e500800986aab6f5a494b063"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acb4cb8a6e500800986aab6f5a494b063"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#acb4cb8a6e500800986aab6f5a494b063">m_writeIncidentLightCurve</a></td></tr>
<tr class="memdesc:acb4cb8a6e500800986aab6f5a494b063"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to indicate whether or not incident light curves will be output. <br /></td></tr>
<tr class="separator:acb4cb8a6e500800986aab6f5a494b063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab72b06a90bc9c9fe3568e9127b2e2864"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab72b06a90bc9c9fe3568e9127b2e2864"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#ab72b06a90bc9c9fe3568e9127b2e2864">m_extractLightCurve</a></td></tr>
<tr class="memdesc:ab72b06a90bc9c9fe3568e9127b2e2864"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to indicate whether or not extracted light curves will be output. <br /></td></tr>
<tr class="separator:ab72b06a90bc9c9fe3568e9127b2e2864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a297768ee6640d911aff623ce67165f4e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a297768ee6640d911aff623ce67165f4e"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a297768ee6640d911aff623ce67165f4e">m_generateNoiseCurve</a></td></tr>
<tr class="memdesc:a297768ee6640d911aff623ce67165f4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to indicate whether or not a noise curve will be output. <br /></td></tr>
<tr class="separator:a297768ee6640d911aff623ce67165f4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7170245f67e41a53d0ead5ff51f3e58"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af7170245f67e41a53d0ead5ff51f3e58"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#af7170245f67e41a53d0ead5ff51f3e58">m_truthBarycentre</a></td></tr>
<tr class="memdesc:af7170245f67e41a53d0ead5ff51f3e58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to indicate whether to use the truth barycentre or the barycentre determined by photometry. <br /></td></tr>
<tr class="separator:af7170245f67e41a53d0ead5ff51f3e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67f4b065a2494dccd2ab0734b58a9ea0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a67f4b065a2494dccd2ab0734b58a9ea0"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a67f4b065a2494dccd2ab0734b58a9ea0">m_subtractFlatField</a></td></tr>
<tr class="memdesc:a67f4b065a2494dccd2ab0734b58a9ea0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to indicate whether or not to perform flat field correction. <br /></td></tr>
<tr class="separator:a67f4b065a2494dccd2ab0734b58a9ea0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a780ff9c7ef39415bb42e24d2e9f08942"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a780ff9c7ef39415bb42e24d2e9f08942"></a>
<a class="el" href="class_photometry.html">Photometry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a780ff9c7ef39415bb42e24d2e9f08942">m_photometry</a></td></tr>
<tr class="memdesc:a780ff9c7ef39415bb42e24d2e9f08942"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to an instance of the <a class="el" href="class_photometry.html" title="Class to perform photometric extraction from an Image. ">Photometry</a> class, used to perform the photometric extraction. <br /></td></tr>
<tr class="separator:a780ff9c7ef39415bb42e24d2e9f08942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03d6723b2c4290062d5b7563c84121ba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a03d6723b2c4290062d5b7563c84121ba"></a>
RANDOM_POISSON *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a03d6723b2c4290062d5b7563c84121ba">m_poissonNoiseGenerator</a></td></tr>
<tr class="memdesc:a03d6723b2c4290062d5b7563c84121ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poisson random number generator to generate the ideal light curve. <br /></td></tr>
<tr class="separator:a03d6723b2c4290062d5b7563c84121ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a0bb78a6b80ecd91fdb3f8b82c67397"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1a0bb78a6b80ecd91fdb3f8b82c67397"></a>
RANDOM_GAUSS *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_reduction.html#a1a0bb78a6b80ecd91fdb3f8b82c67397">m_gaussianNoiseGenerator</a></td></tr>
<tr class="memdesc:a1a0bb78a6b80ecd91fdb3f8b82c67397"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gaussian random number generator for read noise. <br /></td></tr>
<tr class="separator:a1a0bb78a6b80ecd91fdb3f8b82c67397"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_class_module"><td colspan="2" onclick="javascript:toggleInherit('pub_types_class_module')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="class_module.html">Module</a></td></tr>
<tr class="memitem:ac47ec2094c2373341b6b9e2cce7b12bc inherit pub_types_class_module"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_module.html#ac47ec2094c2373341b6b9e2cce7b12bc">SCHEDULE</a> { <a class="el" href="class_module.html#ac47ec2094c2373341b6b9e2cce7b12bca2a60fcf825bbcc04736688150adc2d4c">begin</a>, 
<a class="el" href="class_module.html#ac47ec2094c2373341b6b9e2cce7b12bcabbb5130de0a6b70ac5313e4d51e0b896">timeLoop</a>, 
<a class="el" href="class_module.html#ac47ec2094c2373341b6b9e2cce7b12bca5dd3a2edeb11d510790e6173ed9e9727">end</a>
 }</td></tr>
<tr class="memdesc:ac47ec2094c2373341b6b9e2cce7b12bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">enum to define the scheduling of the module in <a class="el" href="class_simulator.html#a9c48ff02c0acfab6c6e5c512a38d3cc2" title="Runs the Simulator by initializing and running all Modules. ">Simulator::process()</a>  <a href="class_module.html#ac47ec2094c2373341b6b9e2cce7b12bc">More...</a><br /></td></tr>
<tr class="separator:ac47ec2094c2373341b6b9e2cce7b12bc inherit pub_types_class_module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_class_module"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_class_module')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="class_module.html">Module</a></td></tr>
<tr class="memitem:a38752828c317e81b202ab1c9e4cf7f79 inherit pro_attribs_class_module"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a38752828c317e81b202ab1c9e4cf7f79"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_module.html#a38752828c317e81b202ab1c9e4cf7f79">m_name</a></td></tr>
<tr class="memdesc:a38752828c317e81b202ab1c9e4cf7f79 inherit pro_attribs_class_module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of the module. <br /></td></tr>
<tr class="separator:a38752828c317e81b202ab1c9e4cf7f79 inherit pro_attribs_class_module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5ef8552c8a7e4e1d66244691cc6063c inherit pro_attribs_class_module"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac5ef8552c8a7e4e1d66244691cc6063c"></a>
<a class="el" href="class_module.html#ac47ec2094c2373341b6b9e2cce7b12bc">SCHEDULE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_module.html#ac5ef8552c8a7e4e1d66244691cc6063c">m_schedule</a></td></tr>
<tr class="memdesc:ac5ef8552c8a7e4e1d66244691cc6063c inherit pro_attribs_class_module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scheduling of the module in the processing sequence. <br /></td></tr>
<tr class="separator:ac5ef8552c8a7e4e1d66244691cc6063c inherit pro_attribs_class_module"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module performs a basic photometric extraction from the set of stacked images that have been generated. </p>
<hr/>
 <dl class="section author"><dt>Author</dt><dd>David Futyan UGE</dd></dl>
<p>The module can be configured to output normalized and un-normalized incident and extracted light curves, as well as a noise curve. Aperture photometry is performed using the <a class="el" href="class_photometry.html" title="Class to perform photometric extraction from an Image. ">Photometry</a> class. The centre of the aperture can either be the truth <a class="el" href="class_p_s_f.html" title="Class to hold PSF truth information: the flux and list of positions during the exposure. ">PSF</a> position (default), or the barycentre determined by photometry. Options include background subtraction based on the median value within an anulus, and flat field correction. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="add2ae86b0e9ba53b9602f515509ac09d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::doBegin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fullFrame</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Further module initialization with access to data initialized by other modules. Called after preceding modules have been initialized. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fullFrame</td><td>Boolean to indicate whether or not a full frame image is to be generated </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="class_module.html#a8468ed751f03ec474f966f21de09f9bf">Module</a>.</p>

</div>
</div>
<a class="anchor" id="a02e683da2d5cbabb94b4808b2d8754c0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::doEnd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For processing of data after the time loop (data reduction) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the data </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="class_module.html#afcf3db577060d3eb04d858655d09c775">Module</a>.</p>

</div>
</div>
<a class="anchor" id="a042f2a5b8c36cd293a830a3ce2392956"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::extractFluxesFromCube </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>nFiles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>nImages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="struct_data_reduction_1_1_flux.html">Flux</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>extractedFlux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform photometric extraction for images within the current image cube and assigns jitter AOCS and science validity flags. Calls <a class="el" href="class_photometry.html#ab640711a69e3b047a2a9a6c163f26e34" title="Performs photometric extraction, optionally with background subtraction and flat field correction...">Photometry::extractFlux</a> for each image. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the <a class="el" href="class_data.html" title="Data container for CHEOPSim. ">Data</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Filename for the image cube </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Filename for the image cube </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nFiles</td><td>Counter to keep track of the number of files that have been read </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nImages</td><td>Counter to keep track of the total number of images that have been processed </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">extractedFlux</td><td><a class="el" href="struct_data_reduction_1_1_flux.html" title="Struct to hold the extracted flux time series. ">Flux</a> vector containing the extracted flux for each time step of the simulation, together with jitter AOCS and science validity flags </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a31c847bf3055e3eca136362e34c2172c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="struct_data_reduction_1_1_flux.html">DataReduction::Flux</a> &gt; DataReduction::extractFluxVector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform photometric extraction: reads in the set of image cubes and for each cube calls extractFluxesFromCube. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the <a class="el" href="class_data.html" title="Data container for CHEOPSim. ">Data</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="struct_data_reduction_1_1_flux.html" title="Struct to hold the extracted flux time series. ">Flux</a> vector containing the extracted flux for each time step of the simulation, together with jitter AOCS and science validity flags </dd></dl>

</div>
</div>
<a class="anchor" id="a1b3f671d10063931688b1cf1e7b8ac51"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::generateNoiseCurve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UTC&#160;</td>
          <td class="paramname"><em>lastImageMidTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate a noise curve from the data in the extracted light curve. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the <a class="el" href="class_data.html" title="Data container for CHEOPSim. ">Data</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flux</td><td>Vector of normalized transit subtracted flux values for each time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lastImageMidTime</td><td>Mid time of the last image of the simulation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Name of the SIM_ANA_NoiseCurve FITS file </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a502c2f8301c7f0dbf997b99da38a5c2d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::initialize </td>
          <td>(</td>
          <td class="paramtype">const ModuleParams &amp;&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the module by reading in parameters from the configuration file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">params</td><td>Pointer to an instance of ProgramParams containing the CHEOPSim input parameters read in from the CHEOPSim configuration xml file </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="class_module.html#af4c2d2bdeb5d914c4afe75334ec79662">Module</a>.</p>

</div>
</div>
<a class="anchor" id="aca48f611bd601bc5add6922eb6d745ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::process </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fullFrame</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Processing of the data. Called for each time step of the simulation if Module::Schedule is timeLoop (default), otherwise called once. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeStep</td><td>Index of the current time step (only for Module::Schedule==timeloop) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fullFrame</td><td>Boolean to indicate whether or not a full frame image is to be generated </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="class_module.html#a2c3a2985dc3e1b5df7cc38cc200dba54">Module</a>.</p>

</div>
</div>
<a class="anchor" id="ab80507d02d7302887837a538c5dd4f6e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::setLightCurveData </td>
          <td>(</td>
          <td class="paramtype">SciCorLightcurve *&#160;</td>
          <td class="paramname"><em>lightCurve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UTC&#160;</td>
          <td class="paramname"><em>midTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rollAngle</em> = <code>-1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>centroidX</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>centroidY</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>locationX</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>locationY</em> = <code>0.</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write a row of the light curve FITS table. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lightCurve</td><td>Pointer to the light curve FITS table </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flux</td><td>Value of the flux for the current time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">midTime</td><td>UTC mid time of the current time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">status</td><td>Status flag with value 0 to 3, depending on the jitter AOCS and science validity flags </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rollAngle</td><td>Roll angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">centroidX</td><td>X location of centroid w.r.t. left edge of exposed part of CCD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">centroidY</td><td>Y location of centroid w.r.t. bottom edge of exposed part of CCD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">locationX</td><td>X intended location of target w.r.t. left edge of exposed part of CCD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">locationY</td><td>Y intended location of target w.r.t. bottom edge of exposed part of CCD </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6e627007269157d825523862245b1b0a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::setLightCurveHeaderKeywords </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SciCorLightcurve *&#160;</td>
          <td class="paramname"><em>lightCurve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UTC&#160;</td>
          <td class="paramname"><em>lastImageMidTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>photometry</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the header keywords for a light curve, calling either setLightCurveHeaderKeywordsFromImageCube or setLightCurveHeaderKeywordsWithoutImageCube. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the <a class="el" href="class_data.html" title="Data container for CHEOPSim. ">Data</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lightCurve</td><td>Pointer to the light curve FITS table </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lastImageMidTime</td><td>Mid time of the last image of the simulation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">photometry</td><td>Boolean to indicate whether or not LC is from photometric extraction </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5f49f89d6f23d1d347f526e6952f25b6"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::setLightCurveHeaderKeywordsFromImageCube </td>
          <td>(</td>
          <td class="paramtype">SciCorLightcurve *&#160;</td>
          <td class="paramname"><em>lightCurve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>imageCube</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the header keywords for a light curve by copying header keywords from the last image cube to be processed. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lightCurve</td><td>Pointer to the light curve FITS table </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">imageCube</td><td>Pointer to the last FITS image cube to be read </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2e535ce9318f2501e73edc328e6e6c8a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::setLightCurveHeaderKeywordsWithoutImageCube </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SciCorLightcurve *&#160;</td>
          <td class="paramname"><em>lightCurve</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For the case where only an incident light curve is generated such that there are no image cubes, set the header keywords explicitly. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the <a class="el" href="class_data.html" title="Data container for CHEOPSim. ">Data</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lightCurve</td><td>Pointer to the light curve FITS table </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a958aff2212703f0704826c437d512ef3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::setNoiseCurveHeaderKeywordsFromImageCube </td>
          <td>(</td>
          <td class="paramtype">SimAnaNoisecurve &amp;&#160;</td>
          <td class="paramname"><em>noiseCurve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>imageCube</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the header keywords for the noise curve by copying header keywords from the last image cube to be processed. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">noiseCurve</td><td>Pointer to the noise curve FITS table </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">imageCube</td><td>Pointer to the last FITS image cube to be read </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab2ba9e7b8c4edbeb0fc7ac47cce671b3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::setTimeConfigurationFromImageCube </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>nImages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For the case where data reduction is run on a pre-existing set of images from an earlier simulation, use the total number of images that have been processed together with header keywords from the image cubes to define the time configuration, so that time related header keywords can be set for the output light curves. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the <a class="el" href="class_data.html" title="Data container for CHEOPSim. ">Data</a> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nImages</td><td>Total number of images that have been processed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a10404d8ce1fcf740ede37a8c7df5df26"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::writeExtractedFlux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>flux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Appends the extracted flux from the first image to an ascii file. This can be used together with the extractedFlux.sh script to generate an array of extracted flux values for different magnitudes and spectral types. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the <a class="el" href="class_data.html" title="Data container for CHEOPSim. ">Data</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flux</td><td>extracted flux in ADU </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4a759e9093b90c45b19785c55d2f7550"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::writeIncidentLightCurve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write the incident light curve, including normalized curve. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the <a class="el" href="class_data.html" title="Data container for CHEOPSim. ">Data</a> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a31699d58ae64ce9a433ab362427c8068"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataReduction::writeOutputLightCurves </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="struct_data_reduction_1_1_flux.html">Flux</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>extractedFlux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write the output light curves, including normalized and O-C curves. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the <a class="el" href="class_data.html" title="Data container for CHEOPSim. ">Data</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">extractedFlux</td><td><a class="el" href="struct_data_reduction_1_1_flux.html" title="Struct to hold the extracted flux time series. ">Flux</a> vector containing the extracted flux for each time step of the simulation, together with jitter AOCS and science validity flags </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>simulator/include/<a class="el" href="_data_reduction_8hxx_source.html">DataReduction.hxx</a></li>
<li>simulator/src/DataReduction.cxx</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed May 5 2021 21:04:02 for CHEOPSim by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
